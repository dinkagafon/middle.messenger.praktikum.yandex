!function(){function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},a={},s=r.parcelRequiref6c0;function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e,n,r,i,a,s){try{var o=t[a](s),u=o.value}catch(t){return void n(t)}o.done?e(u):Promise.resolve(u).then(r,i)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function s(t){u(a,r,i,s,o,"next",t)}function o(t){u(a,r,i,s,o,"throw",t)}s(void 0)}))}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t){return p(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){d(t,e,n[e])}))}return t}function b(t){return t&&t.constructor===Symbol?"symbol":typeof t}function k(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?o(t):e}function w(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function E(t,e){return function(t){if(Array.isArray(t))return t}(t)||w(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||w(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}null==s&&((s=function(t){if(t in i)return i[t].exports;if(t in a){var e=a[t];delete a[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){a[t]=e},r.parcelRequiref6c0=s),s.register("aP6MD",(function(e,n){var r,i;t(e.exports,"resolve",(function(){return r}),(function(t){return r=t})),t(e.exports,"register",(function(){return i}),(function(t){return i=t}));var a={};i=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)a[e[n]]=t[e[n]]},r=function(t){var e=a[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),s("aP6MD").register(JSON.parse('{"3rcRr":"404.a93c5be0.js","20k4a":"avatar.d36d91cd.jpg"}'));var x=new Uint8Array(16);function S(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(x)}var T=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var A=function(t){return"string"==typeof t&&T.test(t)},C=[],L=0;L<256;++L)C.push((L+256).toString(16).substr(1));var O=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(C[t[e+0]]+C[t[e+1]]+C[t[e+2]]+C[t[e+3]]+"-"+C[t[e+4]]+C[t[e+5]]+"-"+C[t[e+6]]+C[t[e+7]]+"-"+C[t[e+8]]+C[t[e+9]]+"-"+C[t[e+10]]+C[t[e+11]]+C[t[e+12]]+C[t[e+13]]+C[t[e+14]]+C[t[e+15]]).toLowerCase();if(!A(n))throw TypeError("Stringified UUID is invalid");return n};var P=function(t,e,n){var r=(t=t||{}).random||(t.rng||S)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return O(r)},F=function(){"use strict";function t(){l(this,t),this.listeners={}}return h(t,[{key:"on",value:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"off",value:function(t,e){if(!this.listeners[t])throw new Error("Нет события: ".concat(t));this.listeners[t]=this.listeners[t].filter((function(t){return t!==e}))}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(!this.listeners[t])throw new Error("Нет события: ".concat(t));this.listeners[t].forEach((function(t){t.apply(void 0,_(n))}))}}]),t}(),I=function(){"use strict";function t(e,n,r){var i=void 0===e?"div":e,a=void 0===n?{}:n,s=void 0===r?{}:r;l(this,t);var o=new F;this.meta={tagName:i,props:s,attrs:a},this.id=P();var u=g({},s);u.events&&(u.events=this.bindBlockToEvents(u.events)),this.props=this.makePropsProxy(u),this.attrs=a,this.eventBus=function(){return o},this.registerEvents(o),o.emit(t.EVENTS.INIT)}return h(t,[{key:"registerEvents",value:function(e){e.on(t.EVENTS.INIT,this.init.bind(this)),e.on(t.EVENTS.FLOW_CDM,this.componentDidMountIn.bind(this)),e.on(t.EVENTS.FLOW_CDU,this.componentDidUpdateIn.bind(this)),e.on(t.EVENTS.FLOW_RENDER,this.renderIn.bind(this))}},{key:"bindBlockToEvents",value:function(t){var e={};return Object.entries(t).forEach(function(t){var n=E(t),r=n[0],i=n[1];e[r]=function(t){i(t,this)}.bind(this)}.bind(this)),e}},{key:"makePropsProxy",value:function(e){return new Proxy(e,{set:function(e,n,r){var i=g({},e);return"events"===n?(e[n]=this.bindBlockToEvents(r),!0):(e[n]=r,this.eventBus().emit(t.EVENTS.FLOW_CDU,i,e),!0)}.bind(this)})}},{key:"init",value:function(){this.createResources(),this.eventBus().emit(t.EVENTS.FLOW_CDM)}},{key:"createResources",value:function(){var t=this.meta.tagName;this.elementIn=document.createElement(t)}},{key:"componentDidMountIn",value:function(){this.componentDidMount(),this.eventBus().emit(t.EVENTS.FLOW_RENDER)}},{key:"renderBlocks",value:function(e){var n=document.createElement("template");return n.innerHTML=e,Object.values(this.props).reduce((function(e,n){return Array.isArray(n)&&n.every((function(e){return e instanceof t}))?e.concat(n):(n instanceof t&&e.push(n),e)}),[]).forEach((function(t){var e=n.content.querySelector('[data-uuid="'.concat(t.id,'"]'));e&&e.replaceWith(t.element)})),n.content}},{key:"renderIn",value:function(){var t=this.render();this.removeEvents(),this.removeAttrs();var e=this.renderBlocks(t);this.elementIn.innerHTML="",this.elementIn.appendChild(e),this.addAttrs(),this.addEvents()}},{key:"addAttrs",value:function(){Object.entries(this.attrs).forEach(function(t){var e=E(t),n=e[0],r=e[1];this.elementIn.setAttribute(n,r)}.bind(this))}},{key:"removeAttrs",value:function(){Object.keys(this.attrs).forEach(function(t){this.elementIn.removeAttribute(t)}.bind(this))}},{key:"toString",value:function(){return"<div data-uuid = ".concat(this.id,"></div>")}},{key:"removeEvents",value:function(){this.props.events&&Object.entries(this.props.events).forEach(function(t){var e=E(t),n=e[0],r=e[1];this.element.removeEventListener(n,r)}.bind(this))}},{key:"addEvents",value:function(){this.props.events&&Object.entries(this.props.events).forEach(function(t){var e=E(t),n=e[0],r=e[1];this.element.addEventListener(n,r)}.bind(this))}},{key:"componentDidUpdateIn",value:function(e,n){this.componentDidUpdate(e,n),e!==n&&this.eventBus().emit(t.EVENTS.FLOW_RENDER)}},{key:"element",get:function(){return this.elementIn}},{key:"setProps",value:function(t){t&&Object.assign(this.props,t)}},{key:"render",value:function(){return""}},{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(t,e){}}]),t}();I.EVENTS={INIT:"init",FLOW_CDM:"flow:component-did-mount",FLOW_CDU:"flow:component-did-update",FLOW_RENDER:"flow:render"};var N=I;var R=function(t){var e,n="",r={},i=t||{};return function(t){r.centering=e=function(){var t=this&&this.block;this&&this.attributes;n+='<div class="centering"> ',t&&t(),n+="</div>"},r.centering.call({block:function(){n=n+"<div> "+(null==(e=t)?"":e)+"</div>"}})}.call(this,"form"in i?i.form:"undefined"!=typeof form?form:void 0),n};var D=function(t){var e,n="",r=t||{};return function(t){n=n+'<span class="button__text">'+(null==(e=t)?"":e)+"</span>"}.call(this,"content"in r?r.content:"undefined"!=typeof content?content:void 0),n},U=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"button",{},{fullWidth:t.fullWidth,content:t.content,theme:t.theme,events:{click:t.onclick}}))}return y(e,t),h(e,[{key:"setClass",value:function(){var t="button";this.props.fullWidth&&(t="".concat(t," button_fullWidth")),this.props.theme&&(t="".concat(t," button_theme_").concat(this.props.theme)),this.attrs.class=t}},{key:"render",value:function(){return this.setClass(),D(this.props)}}]),e}(N),j=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"input",{class:"input",placeholder:t.placeholder,name:t.name,type:t.type},{events:t.events,wrong:!1,validFunc:t.validFunc,fullHeight:t.fullHeight,name:t.name}))}return y(e,t),h(e,[{key:"setClass",value:function(){var t="input";this.props.wrong&&(t="".concat(t," input_wrong")),this.props.fullHeight&&(t="".concat(t," input_fullHeight")),this.attrs.class=t}},{key:"render",value:function(){return this.setClass(),""}}]),e}(N);var M=/["&<>]/;var B=function(t){var e,n="",r=t||{};return function(t,r,i){n+='<div class="main-form_content">',function(){var t=i||["There are no values"];if("number"==typeof t.length)for(var r=0,a=t.length;r<a;r++){var s=t[r];n+=null==(e=s)?"":e}else{a=0;for(var r in t){a++;s=t[r];n+=null==(e=s)?"":e}}}.call(this),n=n+'</div><div class="main-form_button">'+(null==(e=t)?"":e)+"</div>",r&&(n=n+'<div class="main-form_error">'+function(t){var e=""+t,n=M.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}(null==(e=r)?"":e)+"</div>")}.call(this,"button"in r?r.button:"undefined"!=typeof button?button:void 0,"error"in r?r.error:"undefined"!=typeof error?error:void 0,"fields"in r?r.fields:"undefined"!=typeof fields?fields:void 0),n},V=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,{fields:t.fields,buttonText:t.buttonText,valid:t.valid,error:t.error,submit:t.submit}))}return y(e,t),h(e,[{key:"render",value:function(){return B({button:this.props.button,fields:this.props.fields,error:this.props.error})}}]),e}(function(t){"use strict";function e(t){var n;l(this,e);var r=t.fields.map((function(t){return new j({events:{blur:function(t,e){n.checkInput(e)},focus:function(e,n){t.validFunc&&n.setProps({wrong:!1})}},validFunc:t.validFunc,placeholder:t.placeholder,name:t.name,type:t.type})}));return n=k(this,v(e).call(this,"div",{},{fields:r,button:new U({content:t.buttonText,fullWidth:!0,onclick:function(){var e=n.getFormValues();t.valid?n.checkValidFields()&&t.submit(e):t.submit(e)}})}))}return y(e,t),h(e,[{key:"checkInput",value:function(t){if(t.props.validFunc){var e=t.element;t.props.validFunc(e.value)||t.setProps({wrong:!0})}}},{key:"checkValidFields",value:function(){var t=!0;return this.props.fields.forEach(function(e){this.checkInput(e),!0===e.props.wrong&&(t=!1)}.bind(this)),t}},{key:"setFormValues",value:function(t){Object.entries(t).forEach(function(t){var e=E(t),n=e[0],r=e[1],i=this.props.fields.find((function(t){return t.props.name===n}));i&&(i.element.value=r)}.bind(this))}},{key:"getFormValues",value:function(){return this.props.fields.reduce((function(t,e){return g({},t,d({},e.attrs.name,e.element.value))}),{})}}]),e}(N));var W=/["&<>]/;var q=function(t){var e,n="",r=t||{};return function(t,r,i){n=n+'<div class="identification"><div class="identification_body"><div class="identification_title">'+function(t){var e=""+t,n=W.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}(null==(e=i)?"":e)+'</div><div class="identification_form">'+(null==(e=t)?"":e)+'</div></div><div class="identification_helper">'+(null==(e=r)?"":e)+"</div></div>"}.call(this,"form"in r?r.form:"undefined"!=typeof form?form:void 0,"helper"in r?r.helper:"undefined"!=typeof helper?helper:void 0,"title"in r?r.title:"undefined"!=typeof title?title:void 0),n},H=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{title:t.title,form:t.form,helper:t.helper}))}return y(e,t),h(e,[{key:"render",value:function(){return q({title:this.props.title,form:this.props.form,helper:this.props.helper})}}]),e}(N);var G=/["&<>]/;var Z,z=function(t){var e,n="",r=t||{};return function(t,r){n=n+'<div class="helper"><span class="helper__text">'+function(t){var e=""+t,n=G.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}(null==(e=r)?"":e)+'  <span class="helper__button">'+(null==(e=t)?"":e)+"</span></span></div>"}.call(this,"link"in r?r.link:"undefined"!=typeof link?link:void 0,"text"in r?r.text:"undefined"!=typeof text?text:void 0),n},$=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{text:t.text,link:new U({onclick:t.onclick,content:t.textLink,theme:"link"})}))}return y(e,t),h(e,[{key:"render",value:function(){return z({text:this.props.text,link:this.props.link})}}]),e}(N),J=function(){"use strict";function t(e,n,r){l(this,t),this.pathname=e,this.BlockClass=n,this.block=null,this.currentRoot=r}return h(t,[{key:"match",value:function(t){return this.pathname.startsWith(t)}},{key:"render",value:function(){this.block=new this.BlockClass,this.currentRoot.innerHTML="",this.currentRoot.appendChild(this.block.element)}}]),t}(),Y=function(){"use strict";function t(e){if(l(this,t),t.instance)return t.instance;if(!e)throw Error("undefind root node");this.routes=[],this.history=window.history,this.currentRoot=e,t.instance=this}return h(t,[{key:"use",value:function(t,e){var n=new J(t,e,this.currentRoot);return this.routes.push(n),this}},{key:"start",value:function(){window.onpopstate=function(t){var e=t.target;this.onRoute(e.location.pathname)}.bind(this),this.onRoute(window.location.pathname)}},{key:"onRoute",value:function(t){var e=this.getRoute(t);e&&e.render()}},{key:"go",value:function(t){this.history.pushState({},t,t),this.onRoute(t)}},{key:"back",value:function(){this.history.back()}},{key:"forward",value:function(){this.history.forward()}},{key:"getRoute",value:function(t){return this.routes.find((function(e){return e.match(t)}))}}]),t}(),X=function t(){"use strict";l(this,t)},K="GET",Q="PUT",tt="POST",et="DELETE",nt=function(){"use strict";function t(e,n){var r=void 0===n?{}:n;l(this,t),this.startUrl=e,this.timeout=r.timeout||1e4,this.headers=r.headers||{}}return h(t,[{key:"get",value:function(t){var e=this.startUrl+t;return this.request(e,{method:K})}},{key:"put",value:function(t,e){return this.request(this.startUrl+t,{data:e,method:Q})}},{key:"post",value:function(t,e){return this.request(this.startUrl+t,{data:e,method:tt})}},{key:"delete",value:function(t,e){return this.request(this.startUrl+t,{data:e,method:et})}},{key:"request",value:function(t,e){var n=e.method,r=e.data;return new Promise(function(e,i){var a=new XMLHttpRequest;a.open(n,t),Object.entries(this.headers).forEach((function(t){return(Z=a).setRequestHeader.apply(Z,_(t))})),a.responseType="json",a.onload=function(){a.status<400?e(a.response):i(a.response)},a.onabort=i,a.onerror=i,a.timeout=this.timeout,a.ontimeout=i,a.withCredentials=!0,n!==K&&r?r instanceof FormData?a.send(r):(a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(r))):a.send()}.bind(this))}}]),t}(),rt=new nt("https://ya-praktikum.tech/api/v2/auth"),it=function(t){"use strict";function e(){return l(this,e),k(this,v(e).apply(this,arguments))}return y(e,t),h(e,[{key:"login",value:function(t){return rt.post("/signin",t)}},{key:"logout",value:function(){return rt.post("/logout")}},{key:"create",value:function(t){return rt.post("/signup",t)}},{key:"request",value:function(){return rt.get("/user")}}]),e}(X),at=function(t){return{type:"errors/SETAUTH",payload:t}},st=function(t){return{type:"profile/SET",payload:t}},ot=function(t){return{type:"errors/SETREG",payload:t}},ut=new(function(){"use strict";function t(){l(this,t),this.state={},this.listeners=[],this.reducers={}}return h(t,[{key:"addReducer",value:function(t,e){return this.reducers[t]=e,this.dispatch({type:"@@INIT"}),this}},{key:"getState",value:function(){return this.state}},{key:"dispatch",value:function(t){this.state=this.reducer(t),this.emitListeners()}},{key:"emitListeners",value:function(){this.listeners.forEach(function(t){return t(this.state)}.bind(this))}},{key:"subscribe",value:function(t){t(this.state),this.listeners.push(t)}},{key:"reducer",value:function(t){var e={};return Object.entries(this.reducers).forEach(function(n){var r=E(n),i=r[0],a=r[1];e[i]=a(this.state[i],t)}.bind(this)),e}}]),t}()),ct={},lt=function(t){var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new C(r||[]);return a._invoke=function(t,e,n){var r=f;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return O()}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var o=S(s,n);if(o){if(o===v)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=l(t,e,n);if("normal"===u.type){if(r=n.done?p:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(t,n,s),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f="suspendedStart",h="suspendedYield",d="executing",p="completed",v={};function m(){}function y(){}function g(){}var b={};u(b,a,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(L([])));w&&w!==n&&r.call(w,a)&&(b=w);var E=g.prototype=m.prototype=Object.create(b);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(i,a,s,o){var u=l(t[i],t,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(f).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,o)}))}o(u.arg)}var i;this._invoke=function(t,r){function a(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(a,a):a()}}function S(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function L(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:O}}function O(){return{value:e,done:!0}}return y.prototype=g,u(E,"constructor",g),u(g,"constructor",y),y.displayName=u(g,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,o,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},_(x.prototype),u(x.prototype,s,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var s=new x(c(e,n,r,i),a);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(E),u(E,o,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=L,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return o.type="throw",o.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(ct);try{regeneratorRuntime=lt}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=lt:Function("r","regeneratorRuntime = r")(lt)}var ft=new(function(){"use strict";function t(){l(this,t),this.api=new it}return h(t,[{key:"login",value:function(t){return c(ct.mark((function e(){return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.login(t);case 3:(new Y).go("/"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),ut.dispatch(at(e.t0));case 9:case"end":return e.stop()}}),e,this,[[0,6]])})).bind(this))()}},{key:"logout",value:function(){return c(ct.mark((function t(){return ct.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.api.logout();case 3:(new Y).go("/auth/"),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}}),t,this,[[0,6]])})).bind(this))()}},{key:"reg",value:function(t){return c(ct.mark((function e(){return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.create(t);case 3:(new Y).go("/"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),ut.dispatch(ot(e.t0));case 9:case"end":return e.stop()}}),e,this,[[0,6]])})).bind(this))()}},{key:"getProfile",value:function(){return c(ct.mark((function t(){var e;return ct.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.api.request();case 3:e=t.sent,ut.dispatch(st(e)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(new Y).go("/auth/");case 10:case"end":return t.stop()}}),t,this,[[0,7]])})).bind(this))()}},{key:"checkNotAuth",value:function(){return c(ct.mark((function t(){var e;return ct.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.request();case 2:e=t.sent,(new Y).go("/"),ut.dispatch(st(e));case 5:case"end":return t.stop()}}),t,this)})).bind(this))()}}]),t}());function ht(t){return function(t){return"object"==typeof t&&null!==t&&t.constructor===Object&&"[object Object]"===Object.prototype.toString.call(t)}(t)||function(t){return Array.isArray(t)}(t)}var dt=function t(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;var r=!0,i=!1,a=void 0;try{for(var s,o=Object.entries(e)[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=E(s.value),c=u[0],l=u[1],f=n[c];if(ht(l)&&ht(f)){if(t(l,f))continue;return!1}if(l!==f)return!1}}catch(t){i=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return!0},pt=function(t,e){var n;return function(r){var i=t(r);dt({a:i},{a:n})||(e(i),n=i)}},vt=function(t){return t.errors.reg},mt=function(t){"use strict";function e(){return l(this,e),k(this,v(e).call(this,"div",{},{regForm:new H({title:"Регистрация",form:new V({valid:!0,buttonText:"Зарегистрироваться",fields:[{placeholder:"Имя",name:"first_name",type:"text",validFunc:function(t){return/^[А-ЯA-Z][а-яёЁa-z]+$/.test(t)}},{placeholder:"Фамилия",name:"second_name",type:"text",validFunc:function(t){return/^[А-ЯA-Z][а-яёЁa-z]+$/.test(t)}},{placeholder:"Логин",name:"login",type:"text",validFunc:function(t){return/^(?=.*[a-zA-Z_-])[a-zA-Z0-9-_]{3,20}$/.test(t)}},{placeholder:"Почта",name:"email",type:"text",validFunc:function(t){return/^(?=.*[a-zA-Z_@-])[a-zA-Z_@-]+@[a-zA-Z_-]+\.[a-zA-Z_-]+$/.test(t)}},{placeholder:"Телефон",name:"phone",type:"text",validFunc:function(t){return/^[\d/+]\d{9,14}$/.test(t)}},{placeholder:"Пароль",name:"password",type:"password",validFunc:function(t){return/^(?=.*[A-ZА-Я])(?=.*\d).{8,40}$/.test(t)}}],submit:function(t){ft.reg(t)}}),helper:new $({text:"Уже есть аккаун?",onclick:function(){(new Y).go("/auth/")},textLink:"Войти"})})}))}return y(e,t),h(e,[{key:"componentDidMount",value:function(){ft.checkNotAuth(),document.title="Регистрация";var t=pt((function(t){return vt(t)}),function(t){t&&this.props.regForm.props.form.setProps({error:t.reason})}.bind(this));ut.subscribe((function(e){t(e)}))}},{key:"render",value:function(){return R({form:this.props.regForm})}}]),e}(N);var yt=function(t){var e,n="",r={},i=t||{};return function(t){r.centering=e=function(){var t=this&&this.block;this&&this.attributes;n+='<div class="centering"> ',t&&t(),n+="</div>"},r.centering.call({block:function(){n=n+"<div> "+(null==(e=t)?"":e)+"</div>"}})}.call(this,"form"in i?i.form:"undefined"!=typeof form?form:void 0),n},gt=function(t){return t.errors.auth},bt=function(t){"use strict";ct.mark(e);function e(){var t,n;return l(this,e),t=k(this,v(e).call(this,"div",{},{form:new H({title:"Вход",form:new V({valid:!0,buttonText:"Войти",fields:[{placeholder:"Логин",name:"login",type:"text"},{placeholder:"Пароль",name:"password",type:"password"}],submit:(n=c(ct.mark((function t(e){return ct.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft.login(e);case 2:case"end":return t.stop()}}),t)}))),function(){return n.apply(o(t),arguments)})}),helper:new $({text:"Нет аккаунта?",onclick:function(){(new Y).go("/reg/")},textLink:"Регистрация"})})}))}return y(e,t),h(e,[{key:"componentDidMount",value:function(){document.title="Вход",ft.checkNotAuth();var t=pt((function(t){return gt(t)}),function(t){t&&this.props.form.props.form.setProps({error:t.reason})}.bind(this));ut.subscribe((function(e){t(e)}))}},{key:"render",value:function(){return yt({form:this.props.form})}}]),e}(N),kt=new nt("https://ya-praktikum.tech/api/v2/chats"),wt=function(t){"use strict";function e(){return l(this,e),k(this,v(e).apply(this,arguments))}return y(e,t),h(e,[{key:"request",value:function(){return kt.get("/")}},{key:"create",value:function(t){return kt.post("/",t)}},{key:"token",value:function(t){return kt.post("/token/".concat(t))}}]),e}(X),Et=function(t){return{type:"currentChat/SETACTIVECHATID",payload:t}},_t=function(){return{type:"popUp/SETCHATNAMEDISABLE"}},xt=function(t){return{type:"chats/SET",payload:t}},St=function(t,e){return t.chats.find((function(t){return t.id===e}))},Tt=function(t,e){return{type:"chats/ADDNEWMESSAGES",payload:{chatId:t,messages:e}}},At=function(t,e){return{type:"chats/ADDOLDMESSAGES",payload:{chatId:t,messages:e}}},Ct=function(t){return t.chats.find((function(e){return e.id===t.currentChat.activeChatId}))},Lt=function(t){return t.profile},Ot=new(function(){"use strict";function t(){l(this,t),this.sockets={}}return h(t,[{key:"connect",value:function(t){return c(ct.mark((function e(){var n,r,i,a,s,o;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=ut.getState(),r=Lt(n)){e.next=4;break}return e.abrupt("return");case 4:return i=new wt,e.next=7,i.token(t);case 7:a=e.sent,s=a.token,o=new WebSocket("wss://ya-praktikum.tech/ws/chats/".concat(r.id,"/").concat(t,"/").concat(s)),this.sockets[t]=o,o.addEventListener("message",function(e){this.get(e.data,t)}.bind(this));case 12:case"end":return e.stop()}}),e,this)})).bind(this))()}},{key:"get",value:function(t,e){return c(ct.mark((function n(){var r;return ct.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,JSON.parse(t);case 2:"message"===(r=n.sent).type&&ut.dispatch(Tt(e,[r])),Array.isArray(r)&&ut.dispatch(At(e,r));case 5:case"end":return n.stop()}}),n)})))()}},{key:"send",value:function(t){if(t){var e=ut.getState(),n=Ct(e);n&&this.sockets[n.id].send(JSON.stringify({content:t,type:"message"}))}}},{key:"getlastMessages",value:function(t,e){var n=void 0===e?0:e;return c(ct.mark((function e(){return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sockets[t].send(JSON.stringify({content:n,type:"get old"}));case 1:case"end":return e.stop()}}),e,this)})).bind(this))()}}]),t}()),Pt=new(function(){"use strict";function t(){l(this,t),this.api=new wt}return h(t,[{key:"init",value:function(){return c(ct.mark((function t(){var e;return ct.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.api.request();case 3:e=t.sent,ut.dispatch(xt(e)),e.forEach((function(t){Ot.connect(t.id)})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})).bind(this))()}},{key:"get",value:function(t){return c(ct.mark((function e(){var n,r,i;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ut.dispatch(Et(t)),n=ut.getState(),r=St(n,t)){e.next=5;break}return e.abrupt("return");case 5:(!r.messages||r.messages.length<20)&&(i=r.messages?r.messages.length:0,Ot.getlastMessages(t,i));case 6:case"end":return e.stop()}}),e)})))()}},{key:"create",value:function(t){return c(ct.mark((function e(){return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.create(t);case 3:ut.dispatch(_t()),this.init(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})).bind(this))()}}]),t}());function Ft(t){var e=""+t,n=It.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}var It=/["&<>]/;var Nt=function(t){var e,n="",r=t||{};return function(t,r,i,a,s){n=n+'<div class="chat-item__main"><div class="chat-item__img-container"><img class="chat-item__img"'+function(t,e,n,r){if(!1===e||null==e||!e&&("class"===t||"style"===t))return"";if(!0===e)return" "+(r?t:t+'="'+t+'"');var i=b(e);return"object"!==i&&"function"!==i||"function"!=typeof e.toJSON||(e=e.toJSON()),"string"==typeof e||(e=JSON.stringify(e),n||-1===e.indexOf('"'))?(n&&(e=Ft(e))," "+t+'="'+e+'"'):" "+t+"='"+e.replace(/'/g,"&#39;")+"'"}("src",a,!0,!1)+'/></div><div class="chat-item__content"><p class="chat-item__author">'+Ft(null==(e=t)?"":e)+' </p><p class="chat-item__message">'+Ft(null==(e=s)?"":e)+'</p></div></div><div class="chat-item__meta"><div class="chat-item__count">',0!==r&&(n=n+'<div class="chat-item__count-text">'+Ft(null==(e=r)?"":e)+"</div>"),n=n+'</div><p class="chat-item__date">'+Ft(null==(e=i)?"":e)+"</p></div>"}.call(this,"author"in r?r.author:"undefined"!=typeof author?author:void 0,"count"in r?r.count:"undefined"!=typeof count?count:void 0,"date"in r?r.date:"undefined"!=typeof date?date:void 0,"img"in r?r.img:"undefined"!=typeof img?img:void 0,"message"in r?r.message:"undefined"!=typeof message?message:void 0),n},Rt=function(t){"use strict";function e(t){var n;return l(this,e),n=k(this,v(e).call(this,"div",{},{id:t.id,author:t.author,message:t.message,date:t.date,count:t.count,img:t.img,active:!1,events:{click:function(){Pt.get(n.props.id)}}}))}return y(e,t),h(e,[{key:"setClass",value:function(){var t="chat-item";this.props.active&&(t="".concat(t," chat-item_active")),this.attrs.class=t}},{key:"componentDidMount",value:function(){var t=pt((function(t){return Ct(t)}),function(t){t&&this.setProps({active:this.props.id===t.id})}.bind(this));ut.subscribe((function(e){t(e)}))}},{key:"render",value:function(){return this.setClass(),Nt(this.props)}}]),e}(N);function Dt(t){var e=""+t,n=Ut.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}var Ut=/["&<>]/;var jt=function(t){var e,n="",r=t||{};return function(t,r){n=n+'<div class="profile-button"><div class="profile-button__img-container"><img class="profile-button__img"'+function(t,e,n,r){if(!1===e||null==e||!e&&("class"===t||"style"===t))return"";if(!0===e)return" "+(r?t:t+'="'+t+'"');var i=b(e);return"object"!==i&&"function"!==i||"function"!=typeof e.toJSON||(e=e.toJSON()),"string"==typeof e||(e=JSON.stringify(e),n||-1===e.indexOf('"'))?(n&&(e=Dt(e))," "+t+'="'+e+'"'):" "+t+"='"+e.replace(/'/g,"&#39;")+"'"}("src",t,!0,!1)+'/></div><p class="profile-button__name">'+Dt(null==(e=r)?"":e)+"</p></div>"}.call(this,"avatar"in r?r.avatar:"undefined"!=typeof avatar?avatar:void 0,"name"in r?r.name:"undefined"!=typeof name?name:void 0),n},Mt=function(t){"use strict";function e(t){var n;return l(this,e),n=k(this,v(e).call(this,"div",{},{avatar:t.avatar,name:t.name,link:t.link,events:{click:function(){n.props.link&&(new Y).go(n.props.link)}}}))}return y(e,t),h(e,[{key:"render",value:function(){return jt(this.props)}}]),e}(N);var Bt=function(t){var e,n="",r=t||{};return function(t,r,i,a){n=n+'<div class="chat-list__search">'+(null==(e=a)?"":e)+'</div><div class="chat-list__bar">'+(null==(e=r)?"":e)+'</div><div class="chat-list__footer"> <div class="chat-list__profile">'+(null==(e=i)?"":e)+'</div><div class="chat-list__add">'+(null==(e=t)?"":e)+" </div></div>"}.call(this,"addChatButton"in r?r.addChatButton:"undefined"!=typeof addChatButton?addChatButton:void 0,"chatBar"in r?r.chatBar:"undefined"!=typeof chatBar?chatBar:void 0,"profile"in r?r.profile:"undefined"!=typeof profile?profile:void 0,"search"in r?r.search:"undefined"!=typeof search?search:void 0),n},Vt=function(t){return t.chats},Wt=function(){return{type:"popUp/SETCHATNAMEACTIVE"}},qt=function(t){var e=new Date(Date.parse(t));return"".concat(e.getHours(),":").concat(e.getMinutes())};var Ht,Gt=function(t){var e,n="",r=t||{};return function(t){(function(){var r=t||["There are no values"];if("number"==typeof r.length)for(var i=0,a=r.length;i<a;i++){var s=r[i];n+=null==(e=s)?"":e}else{a=0;for(var i in r){a++;s=r[i];n+=null==(e=s)?"":e}}}).call(this)}.call(this,"chats"in r?r.chats:"undefined"!=typeof chats?chats:void 0),n},Zt=function(t){"use strict";function e(){return l(this,e),k(this,v(e).call(this,"div",{},{chats:[],searchValue:""}))}return y(e,t),h(e,[{key:"render",value:function(){var t=this.props.chats.filter(function(t){return t.props.author.startsWith(this.props.searchValue)}.bind(this));return Gt({chats:t})}}]),e}(N);s.register("8xtoP",(function(e,n){var r;t(e.exports,"getBundleURL",(function(){return r}),(function(t){return r=t}));var i={};function a(t){return(""+t).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}r=function(t){var e=i[t];return e||(e=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return a(t[2])}return"/"}(),i[t]=e),e}})),Ht=s("8xtoP").getBundleURL("3rcRr")+s("aP6MD").resolve("20k4a");var zt=function(t){return t?"https://ya-praktikum.tech/api/v2/resources".concat(t):e(Ht)},$t=function(t){"use strict";function e(){var t;return l(this,e),t=k(this,v(e).call(this,"div",{},{chatBar:new Zt,search:new j({placeholder:"Поиск по чатам",name:"search",type:"text",events:{input:function(e){if(e.target){var n=e.target;t.props.chatBar.setProps({searchValue:n.value})}}}}),addChatButton:new U({content:"Новый чат",onclick:function(){ut.dispatch(Wt())}}),profile:new Mt({avatar:"",link:"/profile/",name:""})}))}return y(e,t),h(e,[{key:"setClass",value:function(){this.attrs.class="chat-list"}},{key:"componentDidMount",value:function(){var t=pt((function(t){return Vt(t)}),function(t){this.props.chatBar.setProps({chats:t.map((function(t){var e=t.messages?t.messages[0]:t.last_message;return new Rt({id:t.id,author:t.title,message:e?e.content:"Пока нет сообщений",date:e?qt(e.time):"",count:t.unread_count,img:zt(t.avatar)})}))})}.bind(this)),e=pt((function(t){return Lt(t)}),function(t){t&&this.props.profile.setProps({avatar:zt(t.avatar),name:"".concat(t.first_name," ").concat(t.second_name)})}.bind(this));ut.subscribe((function(n){t(n),e(n)}))}},{key:"render",value:function(){return this.setClass(),Bt(this.props)}}]),e}(N);var Jt=function(t){var e,n="",r=t||{};return function(t,r,i,a){n=n+((null==(e=t)?"":e)+"\n")+(null==(e=a)?"":e)+"\n"+(null==(e=r)?"":e)+"\n"+(null==(e=i)?"":e)}.call(this,"chatList"in r?r.chatList:"undefined"!=typeof chatList?chatList:void 0,"chatNamePopUp"in r?r.chatNamePopUp:"undefined"!=typeof chatNamePopUp?chatNamePopUp:void 0,"chatSettingsPopUp"in r?r.chatSettingsPopUp:"undefined"!=typeof chatSettingsPopUp?chatSettingsPopUp:void 0,"chatWindow"in r?r.chatWindow:"undefined"!=typeof chatWindow?chatWindow:void 0),n};var Yt=function(t){var e,n="",r=t||{};return function(t,r,i,a){n=n+'<div class="chat-window__header"> <div class="chat-window__profile"> '+(null==(e=a)?"":e)+'</div><div class="chat-window__settings-button"> '+(null==(e=t)?"":e)+'</div></div><div class="chat-window__messeges">'+(null==(e=i)?"":e)+'</div><div class="chat-window__input">'+(null==(e=r)?"":e)+"</div>"}.call(this,"chatSettingsButton"in r?r.chatSettingsButton:"undefined"!=typeof chatSettingsButton?chatSettingsButton:void 0,"message"in r?r.message:"undefined"!=typeof message?message:void 0,"messagesList"in r?r.messagesList:"undefined"!=typeof messagesList?messagesList:void 0,"profile"in r?r.profile:"undefined"!=typeof profile?profile:void 0),n};var Xt=function(t){var e,n="",r=t||{};return function(t,r){n=n+'<div class="create-message"> <div class="create-message_input">'+(null==(e=t)?"":e)+'</div><div class="create-message_button">'+(null==(e=r)?"":e)+"</div></div>"}.call(this,"inputMessage"in r?r.inputMessage:"undefined"!=typeof inputMessage?inputMessage:void 0,"sendButton"in r?r.sendButton:"undefined"!=typeof sendButton?sendButton:void 0),n},Kt=function(t){"use strict";function e(){var t;return l(this,e),t=k(this,v(e).call(this,"div",{},{sendButton:new U({content:"Отправить",onclick:function(){return t.sendMessage()}}),inputMessage:new j({placeholder:"Напишите сообщение",name:"message",type:"text",fullHeight:!0})}))}return y(e,t),h(e,[{key:"sendMessage",value:function(){var t=this.props.inputMessage.element;Ot.send(t.value),t.value=""}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",function(t){"Enter"===t.key&&(t.preventDefault(),this.sendMessage())}.bind(this))}},{key:"render",value:function(){return Xt(this.props)}}]),e}(N),Qt=function(t){var e=Ct(t);return e?e.messages:[]};var te=function(t){var e,n="",r=t||{};return function(t){(function(){var r=t||["There are no values"];if("number"==typeof r.length)for(var i=0,a=r.length;i<a;i++){var s=r[i];n+=null==(e=s)?"":e}else{a=0;for(var i in r){a++;s=r[i];n+=null==(e=s)?"":e}}}).call(this)}.call(this,"messages"in r?r.messages:"undefined"!=typeof messages?messages:void 0),n};function ee(t){var e=""+t,n=ne.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}var ne=/["&<>]/;var re=function(t){var e,n="",r=t||{};return function(t,r){n=n+'<div class="message_content"> '+ee(null==(e=r)?"":e)+'</div><div class="message_footer"> <div class="message_author"> </div><div class="message_date"> '+ee(null==(e=t)?"":e)+"</div></div>"}.call(this,"date"in r?r.date:"undefined"!=typeof date?date:void 0,"text"in r?r.text:"undefined"!=typeof text?text:void 0),n},ie=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{id:t.id,text:t.text,date:t.date,self:t.self}))}return y(e,t),h(e,[{key:"setClass",value:function(){var t="message";this.props.self&&(t="".concat(t," message__self")),this.attrs.class=t}},{key:"render",value:function(){return this.setClass(),re(this.props)}}]),e}(N),ae=function(t){"use strict";function e(){return l(this,e),k(this,v(e).call(this,"div",{},{messages:["dssdf","sdfsf"]}))}return y(e,t),h(e,[{key:"componentDidMount",value:function(){var t=pt((function(t){return{messages:Qt(t),profile:Lt(t)}}),function(t){var e=t.messages,n=t.profile;e&&n&&this.setProps({messages:e.map((function(t){return new ie({id:t.id,text:t.content,date:qt(t.time),self:t.user_id===n.id})}))})}.bind(this));ut.subscribe((function(e){t(e)}))}},{key:"setClass",value:function(){this.attrs.class="messages-list"}},{key:"render",value:function(){return this.setClass(),te(this.props)}}]),e}(N),se=new nt("https://ya-praktikum.tech/api/v2/chats/users"),oe=function(t){"use strict";function e(){return l(this,e),k(this,v(e).apply(this,arguments))}return y(e,t),h(e,[{key:"request",value:function(t){return new nt("https://ya-praktikum.tech/api/v2/chats/".concat(t,"/users")).get("/")}},{key:"create",value:function(t){return se.put("/",{users:[t.userId],chatId:t.chatId})}},{key:"delete",value:function(t){return se.delete("/",{users:[t.userId],chatId:t.chatId})}}]),e}(X),ue=function(){return{type:"popUp/SETCHATSETTINGACTIVE"}},ce=function(t){return{type:"chats/SETMEMBERS",payload:t}},le=new(function(){"use strict";function t(){l(this,t),this.api=new oe}return h(t,[{key:"openMembersPopUp",value:function(){ut.dispatch(ue());var t=Ct(ut.getState());t&&this.get(t.id)}},{key:"get",value:function(t){return c(ct.mark((function e(){var n;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.request(t);case 3:n=e.sent,ut.dispatch(ce({chatId:t,members:n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})).bind(this))()}},{key:"add",value:function(t){return c(ct.mark((function e(){var n;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=Ct(ut.getState())){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.api.create({userId:t,chatId:n.id});case 6:this.get(n.id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})).bind(this))()}},{key:"delete",value:function(t){return c(ct.mark((function e(){var n;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=Ct(ut.getState())){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.api.delete({userId:t,chatId:n.id});case 6:this.get(n.id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})).bind(this))()}}]),t}()),fe=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{name:t.name}))}return y(e,t),h(e,[{key:"setClass",value:function(){var t="icon icon_name_".concat(this.props.name);this.attrs.class=t}},{key:"render",value:function(){return this.setClass(),""}}]),e}(N),he=function(t){"use strict";function n(){return l(this,n),k(this,v(n).call(this,"div",{},{profile:new Mt({avatar:e(Ht),name:""}),chatSettingsButton:new U({content:new fe({name:"sliders"}),theme:"icon",onclick:function(){return le.openMembersPopUp()}}),message:new Kt,messagesList:new ae}))}return y(n,t),h(n,[{key:"setClass",value:function(){this.attrs.class="chat-window"}},{key:"componentDidMount",value:function(){ut.subscribe(function(t){var e=Ct(t);e&&this.props.profile.setProps({avatar:zt(e.avatar),name:e.title})}.bind(this))}},{key:"render",value:function(){return this.setClass(),Yt(this.props)}}]),n}(N);var de=function(t){var e,n="",r=t||{};return function(t){n=n+'<div class="content">'+(null==(e=t)?"":e)+"</div>"}.call(this,"content"in r?r.content:"undefined"!=typeof content?content:void 0),n},pe=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{content:t.content,events:{mousedown:function(e){e.target===e.currentTarget&&t.disableFunc()}},active:t.active}))}return y(e,t),h(e,[{key:"setClass",value:function(){var t="pop-up";t=this.props.active?"".concat(t," pop-up_active"):"".concat(t," pop-up_disable"),this.attrs.class=t}},{key:"render",value:function(){return this.setClass(),de(this.props)}}]),e}(N);var ve=function(t){var e,n="",r=t||{};return function(t){n=n+'<div class="create-chat_title">Новый чат</div><div class="create-chat_form"> '+(null==(e=t)?"":e)+"</div>"}.call(this,"form"in r?r.form:"undefined"!=typeof form?form:void 0),n},me=function(t){"use strict";ct.mark(e);function e(){var t,n;return l(this,e),t=k(this,v(e).call(this,"div",{},{form:new V({valid:!0,buttonText:"Создать чат",fields:[{placeholder:"Название чата",name:"name",type:"text"}],submit:(n=c(ct.mark((function t(e){return ct.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Pt.create({title:e.name});case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(o(t),arguments)})})}))}return y(e,t),h(e,[{key:"setClass",value:function(){this.attrs.class="create-chat"}},{key:"render",value:function(){return this.setClass(),ve(this.props)}}]),e}(N),ye=function(t){return t.popUp.chatName},ge=function(){return{type:"popUp/SETCHATSETTINGDISABLE"}},be=function(t){return t.popUp.chatSetting},ke=new nt("https://ya-praktikum.tech/api/v2/user"),we=function(t){"use strict";function e(){return l(this,e),k(this,v(e).apply(this,arguments))}return y(e,t),h(e,[{key:"search",value:function(t){return ke.post("/search",{login:t})}},{key:"update",value:function(t){return ke.put("/profile",t)}},{key:"updatePassword",value:function(t){return ke.put("/password",t)}},{key:"updateAvatar",value:function(t){return ke.put("/profile/avatar",t)}}]),e}(X),Ee=function(){return{type:"errors/CLEARPASSWORD"}},_e=function(){return{type:"errors/CLEARPROFILE"}},xe=function(t){return{type:"errors/SETPASSWORD",payload:t}},Se=function(t){return{type:"errors/SETPROFILE",payload:t}},Te=function(t){return{type:"searchUsers/SETUSERS",payload:t}},Ae=function(t){var e=Lt(t),n=Ct(t);return(null==e?void 0:e.id)===(null==n?void 0:n.created_by)},Ce=function(t){return t.searchUsers},Le=new(function(){"use strict";function t(){l(this,t),this.api=new we}return h(t,[{key:"search",value:function(t){return c(ct.mark((function e(){var n,r,i;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=ut.getState(),r=Ae(n),!(t.length<3)&&r){e.next=7;break}return Ce(n).length>0&&ut.dispatch(Te([])),e.abrupt("return");case 7:return e.next=9,this.api.search(t);case 9:i=e.sent,ut.dispatch(Te(i)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])})).bind(this))()}},{key:"updateProfile",value:function(t){return c(ct.mark((function e(){var n;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.update(t);case 3:n=e.sent,ut.dispatch(st(n)),ut.dispatch(_e()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),ut.dispatch(Se(e.t0));case 11:case"end":return e.stop()}}),e,this,[[0,8]])})).bind(this))()}},{key:"updatePassword",value:function(t){return c(ct.mark((function e(){return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.updatePassword(t);case 3:ut.dispatch(Ee()),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),ut.dispatch(xe(e.t0));case 9:case"end":return e.stop()}}),e,this,[[0,6]])})).bind(this))()}},{key:"updateAvatar",value:function(t){return c(ct.mark((function e(){var n,r;return ct.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(n=new FormData).append("avatar",t),e.next=5,this.api.updateAvatar(n);case 5:r=e.sent,ut.dispatch(st(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})).bind(this))()}}]),t}());var Oe=function(t){var e=Ct(t);if(!e)return[];var n=e.members||[],r=n.map((function(t){return t.id})),i=Ce(t).filter((function(t){return!r.includes(t.id)})).map((function(t){return g({},t,{role:"none"})}));return n.concat(i)};var Pe=function(t){var e,n="",r=t||{};return function(t){n+='<div class="chat-settings-users">',function(){var r=t||["There are no values"];if("number"==typeof r.length)for(var i=0,a=r.length;i<a;i++){var s=r[i];n+=null==(e=s)?"":e}else{a=0;for(var i in r){a++;s=r[i];n+=null==(e=s)?"":e}}}.call(this),n+="</div>"}.call(this,"members"in r?r.members:"undefined"!=typeof members?members:void 0),n},Fe=function(t){"use strict";function e(){return l(this,e),k(this,v(e).call(this,"div",{},{searchValue:"",members:[]}))}return y(e,t),h(e,[{key:"render",value:function(){var t=this.props.members.filter(function(t){return t.props.login.startsWith(this.props.searchValue)}.bind(this));return Pe({members:t})}}]),e}(N);var Ie=/["&<>]/;var Ne=function(t){var e,n="",r=t||{};return function(t,r,i){n=n+'<div class="chat-settings_header">'+function(t){var e=""+t,n=Ie.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}(null==(e=t)?"":e)+'</div><div class="chat-settings_search">'+(null==(e=i)?"":e)+'</div><div class="chat-settings_members">'+(null==(e=r)?"":e)+"</div>"}.call(this,"header"in r?r.header:"undefined"!=typeof header?header:void 0,"members"in r?r.members:"undefined"!=typeof members?members:void 0,"search"in r?r.search:"undefined"!=typeof search?search:void 0),n};var Re=function(t){var e,n="",r=t||{};return function(t,r){n=n+'<div class="member-itom"><div class="member-itom__profile">'+(null==(e=r)?"":e)+'</div><div class="member-itom__button">'+(null==(e=t)?"":e)+"</div></div>"}.call(this,"button"in r?r.button:"undefined"!=typeof button?button:void 0,"profile"in r?r.profile:"undefined"!=typeof profile?profile:void 0),n},De=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{login:t.member.login,profile:new Mt({avatar:zt(t.member.avatar),name:"".concat(t.member.first_name," ").concat(t.member.second_name," (").concat(t.member.login,")"),link:"/user/".concat(t.member.login)}),button:(n=t.member.role,r=t.member.id,i=t.root,i&&"admin"!==n?new U("none"===n?{content:new fe({name:"plus-square"}),theme:"icon",onclick:function(){return le.add(r)}}:{content:new fe({name:"trash-2"}),theme:"icon",onclick:function(){return le.delete(r)}}):"")}));var n,r,i}return y(e,t),h(e,[{key:"render",value:function(){return Re(this.props)}}]),e}(N),Ue=function(t){"use strict";function e(){var t;return l(this,e),t=k(this,v(e).call(this,"div",{},{header:"",members:new Fe,search:new j({placeholder:"Поиск пользователей",name:"searchUsers",type:"text",events:{input:function(e){if(e.target){var n=e.target;t.props.members.setProps({searchValue:n.value}),Le.search(n.value)}}}})}))}return y(e,t),h(e,[{key:"setClass",value:function(){this.attrs.class="chat-settings"}},{key:"componentDidMount",value:function(){var t=pt((function(t){return Ct(t)}),function(t){t&&this.setProps({header:t.title})}.bind(this)),e=pt((function(t){return{members:Oe(t),root:Ae(t)}}),function(t){var e=t.members,n=t.root;this.props.members.setProps({members:e.map((function(t){return new De({root:n,member:t})}))})}.bind(this));ut.subscribe((function(n){t(n),e(n)}))}},{key:"render",value:function(){return this.setClass(),Ne(this.props)}}]),e}(N),je=function(t){"use strict";function e(){return l(this,e),k(this,v(e).call(this,"div",{},{chatList:new $t,chatWindow:new he,chatNamePopUp:new pe({disableFunc:function(){ut.dispatch(_t())},content:new me,active:!0}),chatSettingsPopUp:new pe({disableFunc:function(){ut.dispatch(ge())},content:new Ue,active:!0})}))}return y(e,t),h(e,[{key:"setClass",value:function(){this.attrs.class="chat"}},{key:"componentDidMount",value:function(){document.title="Практикум чат",ft.getProfile(),Pt.init();var t=pt((function(t){return ye(t)}),function(t){this.props.chatNamePopUp.setProps({active:t})}.bind(this)),e=pt((function(t){return be(t)}),function(t){this.props.chatSettingsPopUp.setProps({active:t})}.bind(this));ut.subscribe((function(n){t(n),e(n)}))}},{key:"render",value:function(){return this.setClass(),Jt({chatList:this.props.chatList,chatWindow:this.props.chatWindow,chatNamePopUp:this.props.chatNamePopUp,chatSettingsPopUp:this.props.chatSettingsPopUp})}}]),e}(N);var Me=function(t){var e,n="",r={},i=t||{};return function(t){r.centering=e=function(){var t=this&&this.block;this&&this.attributes;n+='<div class="centering"> ',t&&t(),n+="</div>"},r.centering.call({block:function(){n=n+"<div> "+(null==(e=t)?"":e)+"</div>"}})}.call(this,"form"in i?i.form:"undefined"!=typeof form?form:void 0),n},Be=function(t){return t.errors.password},Ve=function(t){return t.errors.profile};var We=function(t){var e,n="",r=t||{};return function(t){n=n+'<span class="button__text">'+(null==(e=t)?"":e)+"</span>"}.call(this,"content"in r?r.content:"undefined"!=typeof content?content:void 0),n},qe=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"input",{type:"file",accept:t.accept,id:t.id},{events:{change:t.onchange}}))}return y(e,t),h(e,[{key:"setClass",value:function(){this.attrs.class="input-file"}},{key:"render",value:function(){return this.setClass(),We(this.props)}}]),e}(N);function He(t,e,n,r){if(!1===e||null==e||!e&&("class"===t||"style"===t))return"";if(!0===e)return" "+(r?t:t+'="'+t+'"');var i=b(e);return"object"!==i&&"function"!==i||"function"!=typeof e.toJSON||(e=e.toJSON()),"string"==typeof e||(e=JSON.stringify(e),n||-1===e.indexOf('"'))?(n&&(e=function(t){var e=""+t,n=Ge.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}(e))," "+t+'="'+e+'"'):" "+t+"='"+e.replace(/'/g,"&#39;")+"'"}var Ge=/["&<>]/;var Ze=function(t){var e,n="",r=t||{};return function(t,r,i){n=n+"<label"+He("for",r,!0,!1)+'> <div class="avatar-changer__img-wrapper"><img class="avatar-changer__img"'+He("src",t,!0,!1)+'/></div></label><div class="avatar-changer__input">'+(null==(e=i)?"":e)+"</div>"}.call(this,"avatarLink"in r?r.avatarLink:"undefined"!=typeof avatarLink?avatarLink:void 0,"forId"in r?r.forId:"undefined"!=typeof forId?forId:void 0,"input"in r?r.input:"undefined"!=typeof input?input:void 0),n},ze=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{input:new qe({accept:"image/*",id:t.name,onchange:t.onchange}),forId:t.name,link:t.avatarLink}))}return y(e,t),h(e,[{key:"setClass",value:function(){this.attrs.class="avatar-changer"}},{key:"render",value:function(){return this.setClass(),Ze(this.props)}}]),e}(N);var $e=/["&<>]/;var Je=function(t){var e,n="",r=t||{};return function(t,r,i,a,s){n=n+'<div class="profile-editor"><div class="profile-editor_body"><div class="profile-editor_title">'+function(t){var e=""+t,n=$e.exec(e);if(!n)return t;var r,i,a,s="";for(r=n.index,i=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==r&&(s+=e.substring(i,r)),i=r+1,s+=a}return i!==r?s+e.substring(i,r):s}(null==(e=s)?"":e)+'</div><div class="profile-editor_avatar">'+(null==(e=t)?"":e)+'</div><div class="profile-editor_dataform">'+(null==(e=r)?"":e)+'</div><div class="profile-editor_passwordform">'+(null==(e=a)?"":e)+'</div></div><div class="profile-editor_helper">'+(null==(e=i)?"":e)+"</div></div>"}.call(this,"avatarChanger"in r?r.avatarChanger:"undefined"!=typeof avatarChanger?avatarChanger:void 0,"dataForm"in r?r.dataForm:"undefined"!=typeof dataForm?dataForm:void 0,"helper"in r?r.helper:"undefined"!=typeof helper?helper:void 0,"passwordForm"in r?r.passwordForm:"undefined"!=typeof passwordForm?passwordForm:void 0,"title"in r?r.title:"undefined"!=typeof title?title:void 0),n},Ye=function(t){"use strict";function e(t){return l(this,e),k(this,v(e).call(this,"div",{},{title:t.title,avatarChanger:new ze({name:"avatar",onchange:function(t){null==t||t.preventDefault();var e=(null==t?void 0:t.target).files;if(e&&e[0]){var n=E(e)[0];Le.updateAvatar(n)}},avatarLink:""}),dataForm:new V({valid:!0,buttonText:"Изменить данные",fields:[{placeholder:"Имя",name:"first_name",type:"text",validFunc:function(t){return/^[А-ЯA-Z][а-яёЁa-z]+$/.test(t)}},{placeholder:"Фамилия",name:"second_name",type:"text",validFunc:function(t){return/^[А-ЯA-Z][а-яёЁa-z]+$/.test(t)}},{placeholder:"Логин",name:"login",type:"text",validFunc:function(t){return/^(?=.*[a-zA-Z_-])[a-zA-Z0-9-_]{3,20}$/.test(t)}},{placeholder:"Отображаемый ник",name:"display_name",type:"text"},{placeholder:"Почта",name:"email",type:"text",validFunc:function(t){return/^(?=.*[a-zA-Z_@-])[a-zA-Z_@-]+@[a-zA-Z_-]+\.[a-zA-Z_-]+$/.test(t)}},{placeholder:"Телефон",name:"phone",type:"text",validFunc:function(t){return/^[\d/+]\d{9,14}$/.test(t)}}],submit:function(t){Le.updateProfile(t)}}),passwordForm:new V({valid:!0,buttonText:"Изменить Пароль",fields:[{placeholder:"Старый пароль",name:"oldPassword",type:"password"},{placeholder:"Новый пароль",name:"newPassword",type:"password",validFunc:function(t){return/^(?=.*[A-ZА-Я])(?=.*\d).{8,40}$/.test(t)}}],submit:function(t){Le.updatePassword(t)}}),helper:t.helper}))}return y(e,t),h(e,[{key:"componentDidMount",value:function(){var t=pt((function(t){return Ve(t)}),function(t){this.props.dataForm.setProps({error:t?t.reason:void 0})}.bind(this)),e=pt((function(t){return Be(t)}),function(t){this.props.passwordForm.setProps({error:t?t.reason:void 0})}.bind(this)),n=pt((function(t){return Lt(t)}),function(t){t&&(this.props.avatarChanger.setProps({avatarLink:zt(t.avatar)}),this.props.dataForm.setFormValues({first_name:t.first_name,second_name:t.second_name,login:t.login,display_name:t.display_name,email:t.email,phone:t.phone}))}.bind(this));ut.subscribe((function(r){t(r),e(r),n(r)}))}},{key:"render",value:function(){return Je({title:this.props.title,dataForm:this.props.dataForm,passwordForm:this.props.passwordForm,avatarChangeInput:this.props.avatarChangeInput,helper:this.props.helper,avatarChanger:this.props.avatarChanger})}}]),e}(N),Xe=function(t){"use strict";ct.mark(e);function e(){var t,n;return l(this,e),t=k(this,v(e).call(this,"div",{},{regForm:new Ye({title:"Изменение профиля",helper:new $({text:"",onclick:(n=c(ct.mark((function t(){return ct.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft.logout();case 2:case"end":return t.stop()}}),t)}))),function(){return n.apply(o(t),arguments)}),textLink:"Выйти"})})}))}return y(e,t),h(e,[{key:"componentDidMount",value:function(){document.title="Настройки профиля",ft.getProfile()}},{key:"render",value:function(){return Me({form:this.props.regForm})}}]),e}(N),Ke=function(t,e){var n=void 0===t?{chatSetting:!1,chatName:!1}:t;switch(e.type){case"popUp/SETCHATSETTINGACTIVE":return g({},n,{chatSetting:!0});case"popUp/SETCHATSETTINGDISABLE":return g({},n,{chatSetting:!1});case"popUp/SETCHATNAMEACTIVE":return g({},n,{chatName:!0});case"popUp/SETCHATNAMEDISABLE":return g({},n,{chatName:!1});case"popUp/CLOSEALL":return Object.keys(n).reduce((function(t,e){return g({},t,d({},e,!1))}),{});default:return n}},Qe=function(t,e){var n=void 0===t?[]:t;switch(e.type){case"chats/SET":return e.payload;case"chats/SETMEMBERS":return n.map((function(t){return t.id===e.payload.chatId?g({},t,{members:e.payload.members}):g({},t)}));case"chats/ADDNEWMESSAGES":return n.map((function(t){return t.id===e.payload.chatId?g({},t,{messages:t.messages?e.payload.messages.concat(t.messages):e.payload.messages}):g({},t)}));case"chats/ADDOLDMESSAGES":return n.map((function(t){return t.id===e.payload.chatId?g({},t,{messages:t.messages?t.messages.concat(e.payload.messages):e.payload.messages}):g({},t)}));default:return n}},tn=function(t,e){var n=void 0===t?{id:void 0}:t;switch(e.type){case"currentChat/SETACTIVECHATID":return g({},n,{activeChatId:e.payload});default:return n}},en=function(t,e){var n=void 0===t?[]:t;switch(e.type){case"searchUsers/SETUSERS":return e.payload;default:return n}},nn=function(t,e){switch(e.type){case"profile/SET":return e.payload;default:return t}},rn=function(t,e){var n=void 0===t?{}:t;switch(e.type){case"errors/SETAUTH":return g({},n,{auth:e.payload});case"errors/SETREG":return g({},n,{reg:e.payload});case"errors/SETPROFILE":return g({},n,{profile:e.payload});case"errors/CLEARPROFILE":return g({},n,{profile:void 0});case"errors/SETPASSWORD":return g({},n,{password:e.payload});case"errors/CLEARPASSWORD":return g({},n,{password:void 0});default:return n}},an=function(){ut.addReducer("popUp",Ke).addReducer("chats",Qe).addReducer("currentChat",tn).addReducer("searchUsers",en).addReducer("profile",nn).addReducer("errors",rn)};document.addEventListener("DOMContentLoaded",(function(){var t,e;t=".root",null!==(e=document.querySelector(t))&&(an(),new Y(e).use("/",je).use("/auth/",bt).use("/reg/",mt).use("/profile/",Xe).start())}))}();
//# sourceMappingURL=404.a93c5be0.js.map
